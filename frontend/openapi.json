{"openapi":"3.1.0","info":{"title":"tonari-backend","version":"0.0.1"},"paths":{"/health":{"get":{"summary":"Health","operationId":"health_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/ingest/syosetu":{"post":{"tags":["ingest"],"summary":"Ingest Syosetu","operationId":"ingest_syosetu_ingest_syosetu_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/IngestSyosetuRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChapterOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/chapter-translations/":{"post":{"tags":["chapter-translations"],"summary":"Create Chapter Translation","operationId":"create_chapter_translation_chapter_translations__post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChapterTranslationCreate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChapterTranslationOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/chapter-translations/{ct_id}":{"get":{"tags":["chapter-translations"],"summary":"Get Chapter Translation","operationId":"get_chapter_translation_chapter_translations__ct_id__get","parameters":[{"name":"ct_id","in":"path","required":true,"schema":{"type":"integer","title":"Ct Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChapterTranslationOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/chapter-translations/{ct_id}/segments":{"get":{"tags":["chapter-translations"],"summary":"List Translation Segments","operationId":"list_translation_segments_chapter_translations__ct_id__segments_get","parameters":[{"name":"ct_id","in":"path","required":true,"schema":{"type":"integer","title":"Ct Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TranslationSegmentOut"},"title":"Response List Translation Segments Chapter Translations  Ct Id  Segments Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/models/":{"get":{"tags":["models"],"summary":"List Models","description":"List all available LLM models for translations.","operationId":"list_models_models__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ModelsListOut"}}}}}}},"/prompts/":{"get":{"tags":["prompts"],"summary":"List Prompts","description":"List all prompts globally with optional search.","operationId":"list_prompts_prompts__get","parameters":[{"name":"q","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Q"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":50,"title":"Limit"}},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Offset"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedPromptsOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["prompts"],"summary":"Create Prompt","description":"Create a new global prompt.","operationId":"create_prompt_prompts__post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PromptCreateRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PromptOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/prompts/{prompt_id}":{"get":{"tags":["prompts"],"summary":"Get Prompt","description":"Get a prompt and its metadata including latest version.","operationId":"get_prompt_prompts__prompt_id__get","parameters":[{"name":"prompt_id","in":"path","required":true,"schema":{"type":"integer","title":"Prompt Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PromptDetailOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"tags":["prompts"],"summary":"Update Prompt","description":"Update prompt metadata (name and/or description).","operationId":"update_prompt_prompts__prompt_id__patch","parameters":[{"name":"prompt_id","in":"path","required":true,"schema":{"type":"integer","title":"Prompt Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PromptUpdateRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PromptOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["prompts"],"summary":"Delete Prompt","description":"Soft delete a prompt while retaining historical versions.","operationId":"delete_prompt_prompts__prompt_id__delete","parameters":[{"name":"prompt_id","in":"path","required":true,"schema":{"type":"integer","title":"Prompt Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/prompts/{prompt_id}/versions":{"get":{"tags":["prompts"],"summary":"List Prompt Versions","description":"List all versions of a prompt.","operationId":"list_prompt_versions_prompts__prompt_id__versions_get","parameters":[{"name":"prompt_id","in":"path","required":true,"schema":{"type":"integer","title":"Prompt Id"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":50,"title":"Limit"}},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Offset"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedPromptVersionsOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["prompts"],"summary":"Append Prompt Version","description":"Append a new version to a prompt.","operationId":"append_prompt_version_prompts__prompt_id__versions_post","parameters":[{"name":"prompt_id","in":"path","required":true,"schema":{"type":"integer","title":"Prompt Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PromptVersionCreateRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PromptVersionOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/prompts/{prompt_id}/versions/{version_id}":{"get":{"tags":["prompts"],"summary":"Get Prompt Version","description":"Get a specific version of a prompt.","operationId":"get_prompt_version_prompts__prompt_id__versions__version_id__get","parameters":[{"name":"prompt_id","in":"path","required":true,"schema":{"type":"integer","title":"Prompt Id"}},{"name":"version_id","in":"path","required":true,"schema":{"type":"integer","title":"Version Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PromptVersionOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/prompts/works/{work_id}/prompts":{"get":{"tags":["prompts"],"summary":"List Work Prompts","description":"List prompts available for a specific work.","operationId":"list_work_prompts_prompts_works__work_id__prompts_get","parameters":[{"name":"work_id","in":"path","required":true,"schema":{"type":"integer","title":"Work Id"}},{"name":"q","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Q"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":50,"title":"Limit"}},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Offset"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedPromptsOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/prompts/works/{work_id}/prompt":{"get":{"tags":["prompts"],"summary":"Get Work Prompt","description":"Get the prompt assigned to a work.","operationId":"get_work_prompt_prompts_works__work_id__prompt_get","parameters":[{"name":"work_id","in":"path","required":true,"schema":{"type":"integer","title":"Work Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PromptDetailOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"tags":["prompts"],"summary":"Update Work Prompt","description":"Set or update the default prompt for a work.","operationId":"update_work_prompt_prompts_works__work_id__prompt_patch","parameters":[{"name":"work_id","in":"path","required":true,"schema":{"type":"integer","title":"Work Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/WorkPromptUpdateRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PromptDetailOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/works/{work_id}/chapter-groups":{"post":{"tags":["chapter_groups"],"summary":"Create Chapter Group","description":"Create a new chapter group.","operationId":"create_chapter_group_works__work_id__chapter_groups_post","parameters":[{"name":"work_id","in":"path","required":true,"schema":{"type":"integer","title":"Work Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChapterGroupCreateRequest"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChapterGroupDetailOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/works/{work_id}/chapter-groups/{group_id}":{"get":{"tags":["chapter_groups"],"summary":"Get Chapter Group","description":"Get chapter group details with members.","operationId":"get_chapter_group_works__work_id__chapter_groups__group_id__get","parameters":[{"name":"work_id","in":"path","required":true,"schema":{"type":"integer","title":"Work Id"}},{"name":"group_id","in":"path","required":true,"schema":{"type":"integer","title":"Group Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChapterGroupDetailOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"tags":["chapter_groups"],"summary":"Update Chapter Group","description":"Update chapter group name.","operationId":"update_chapter_group_works__work_id__chapter_groups__group_id__patch","parameters":[{"name":"work_id","in":"path","required":true,"schema":{"type":"integer","title":"Work Id"}},{"name":"group_id","in":"path","required":true,"schema":{"type":"integer","title":"Group Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChapterGroupUpdateRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChapterGroupDetailOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["chapter_groups"],"summary":"Delete Chapter Group","description":"Delete a chapter group.","operationId":"delete_chapter_group_works__work_id__chapter_groups__group_id__delete","parameters":[{"name":"work_id","in":"path","required":true,"schema":{"type":"integer","title":"Work Id"}},{"name":"group_id","in":"path","required":true,"schema":{"type":"integer","title":"Group Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/works/{work_id}/chapter-groups/{group_id}/members":{"put":{"tags":["chapter_groups"],"summary":"Update Chapter Group Members","description":"Update chapter group members (replace all).","operationId":"update_chapter_group_members_works__work_id__chapter_groups__group_id__members_put","parameters":[{"name":"work_id","in":"path","required":true,"schema":{"type":"integer","title":"Work Id"}},{"name":"group_id","in":"path","required":true,"schema":{"type":"integer","title":"Group Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChapterGroupMembersUpdateRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChapterGroupDetailOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/works/":{"get":{"tags":["works"],"summary":"Search Works","operationId":"search_works_works__get","parameters":[{"name":"q","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Q"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":50,"title":"Limit"}},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Offset"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedWorksOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/works/import":{"post":{"tags":["works"],"summary":"Import Work","operationId":"import_work_works_import_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/WorkImportRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/WorkOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/works/{work_id}":{"get":{"tags":["works"],"summary":"Get Work","operationId":"get_work_works__work_id__get","parameters":[{"name":"work_id","in":"path","required":true,"schema":{"type":"integer","title":"Work Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/WorkOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/works/{work_id}/chapters":{"get":{"tags":["works"],"summary":"List Chapters For Work","operationId":"list_chapters_for_work_works__work_id__chapters_get","parameters":[{"name":"work_id","in":"path","required":true,"schema":{"type":"integer","title":"Work Id"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":50,"title":"Limit"}},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Offset"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChaptersWithGroupsResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/works/{work_id}/chapters/{chapter_id}":{"get":{"tags":["works"],"summary":"Get Chapter For Work","operationId":"get_chapter_for_work_works__work_id__chapters__chapter_id__get","parameters":[{"name":"work_id","in":"path","required":true,"schema":{"type":"integer","title":"Work Id"}},{"name":"chapter_id","in":"path","required":true,"schema":{"type":"integer","title":"Chapter Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChapterDetailOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/works/{work_id}/scrape-chapters":{"post":{"tags":["works"],"summary":"Request Chapter Scrape","operationId":"request_chapter_scrape_works__work_id__scrape_chapters_post","parameters":[{"name":"work_id","in":"path","required":true,"schema":{"type":"integer","title":"Work Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChapterScrapeRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChapterScrapeResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/works/{work_id}/scrape-status":{"get":{"tags":["works"],"summary":"Stream Scrape Status","description":"Stream scrape status events for a work.","operationId":"stream_scrape_status_works__work_id__scrape_status_get","parameters":[{"name":"work_id","in":"path","required":true,"schema":{"type":"integer","title":"Work Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/works/{work_id}/chapters/{chapter_id}/translation":{"get":{"tags":["works"],"summary":"Get Chapter Translation State","operationId":"get_chapter_translation_state_works__work_id__chapters__chapter_id__translation_get","parameters":[{"name":"work_id","in":"path","required":true,"schema":{"type":"integer","title":"Work Id"}},{"name":"chapter_id","in":"path","required":true,"schema":{"type":"integer","title":"Chapter Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChapterTranslationStateOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["works"],"summary":"Reset Chapter Translation","operationId":"reset_chapter_translation_works__work_id__chapters__chapter_id__translation_delete","parameters":[{"name":"work_id","in":"path","required":true,"schema":{"type":"integer","title":"Work Id"}},{"name":"chapter_id","in":"path","required":true,"schema":{"type":"integer","title":"Chapter Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChapterTranslationStateOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/works/{work_id}/chapters/{chapter_id}/regenerate-segments":{"post":{"tags":["works"],"summary":"Regenerate Chapter Segments","description":"Regenerate all segments for a chapter, discarding existing translations.\n\nThis endpoint deletes all existing segments for all translations of the chapter\nand recreates them based on the current chapter text. This is useful when the\nchapter source text changes and needs to be re-segmented.","operationId":"regenerate_chapter_segments_works__work_id__chapters__chapter_id__regenerate_segments_post","parameters":[{"name":"work_id","in":"path","required":true,"schema":{"type":"integer","title":"Work Id"}},{"name":"chapter_id","in":"path","required":true,"schema":{"type":"integer","title":"Chapter Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/works/{work_id}/chapters/{chapter_id}/prompt-overrides":{"post":{"tags":["works"],"summary":"Create Chapter Prompt Override","description":"Create a signed prompt override token for a single translation run.","operationId":"create_chapter_prompt_override_works__work_id__chapters__chapter_id__prompt_overrides_post","parameters":[{"name":"work_id","in":"path","required":true,"schema":{"type":"integer","title":"Work Id"}},{"name":"chapter_id","in":"path","required":true,"schema":{"type":"integer","title":"Chapter Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChapterPromptOverrideRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChapterPromptOverrideResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/works/{work_id}/chapters/{chapter_id}/translate/stream":{"get":{"tags":["works"],"summary":"Stream Chapter Translation","operationId":"stream_chapter_translation_works__work_id__chapters__chapter_id__translate_stream_get","parameters":[{"name":"work_id","in":"path","required":true,"schema":{"type":"integer","title":"Work Id"}},{"name":"chapter_id","in":"path","required":true,"schema":{"type":"integer","title":"Chapter Id"}},{"name":"prompt_override_token","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Prompt Override Token"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/works/{work_id}/chapters/{chapter_id}/segments/{segment_id}/retranslate/stream":{"get":{"tags":["works"],"summary":"Retranslate Segment","description":"Retranslate a single segment in a chapter translation.","operationId":"retranslate_segment_works__work_id__chapters__chapter_id__segments__segment_id__retranslate_stream_get","parameters":[{"name":"work_id","in":"path","required":true,"schema":{"type":"integer","title":"Work Id"}},{"name":"chapter_id","in":"path","required":true,"schema":{"type":"integer","title":"Chapter Id"}},{"name":"segment_id","in":"path","required":true,"schema":{"type":"integer","title":"Segment Id"}},{"name":"prompt_override_token","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Prompt Override Token"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/works/{work_id}/chapters/{chapter_id}/segments/{segment_id}/explain/stream":{"get":{"tags":["works"],"summary":"Explain Segment","description":"Stream explanation for a translation segment.","operationId":"explain_segment_works__work_id__chapters__chapter_id__segments__segment_id__explain_stream_get","parameters":[{"name":"work_id","in":"path","required":true,"schema":{"type":"integer","title":"Work Id"}},{"name":"chapter_id","in":"path","required":true,"schema":{"type":"integer","title":"Chapter Id"}},{"name":"segment_id","in":"path","required":true,"schema":{"type":"integer","title":"Segment Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/works/{work_id}/chapters/{chapter_id}/segments/{segment_id}/regenerate-explanation":{"post":{"tags":["works"],"summary":"Regenerate Explanation","description":"Clear and regenerate explanation for a translation segment.","operationId":"regenerate_explanation_works__work_id__chapters__chapter_id__segments__segment_id__regenerate_explanation_post","parameters":[{"name":"work_id","in":"path","required":true,"schema":{"type":"integer","title":"Work Id"}},{"name":"chapter_id","in":"path","required":true,"schema":{"type":"integer","title":"Chapter Id"}},{"name":"segment_id","in":"path","required":true,"schema":{"type":"integer","title":"Segment Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/lab/stream":{"post":{"tags":["lab"],"summary":"Stream Lab Translation","description":"Stream translation for the prompt lab.\nThis endpoint is ephemeral and does not save to the database.","operationId":"stream_lab_translation_lab_stream_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LabStreamRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"ChapterDetailOut":{"properties":{"id":{"type":"integer","title":"Id"},"work_id":{"type":"integer","title":"Work Id"},"idx":{"type":"integer","title":"Idx"},"sort_key":{"type":"number","title":"Sort Key"},"title":{"type":"string","title":"Title"},"normalized_text":{"type":"string","title":"Normalized Text"}},"type":"object","required":["id","work_id","idx","sort_key","title","normalized_text"],"title":"ChapterDetailOut"},"ChapterGroupCreateRequest":{"properties":{"name":{"type":"string","maxLength":512,"minLength":1,"title":"Name","description":"Group name"},"chapter_ids":{"items":{"type":"integer"},"type":"array","minItems":1,"title":"Chapter Ids","description":"List of chapter IDs to include"}},"type":"object","required":["name","chapter_ids"],"title":"ChapterGroupCreateRequest"},"ChapterGroupDetailOut":{"properties":{"id":{"type":"integer","title":"Id"},"work_id":{"type":"integer","title":"Work Id"},"name":{"type":"string","title":"Name"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"},"member_count":{"type":"integer","title":"Member Count","default":0},"min_sort_key":{"type":"number","title":"Min Sort Key"},"item_type":{"type":"string","title":"Item Type","default":"group"},"members":{"items":{"$ref":"#/components/schemas/ChapterGroupMemberOut"},"type":"array","title":"Members"}},"type":"object","required":["id","work_id","name","created_at","updated_at","min_sort_key","members"],"title":"ChapterGroupDetailOut"},"ChapterGroupMemberOut":{"properties":{"id":{"type":"integer","title":"Id"},"chapter_id":{"type":"integer","title":"Chapter Id"},"order_index":{"type":"integer","title":"Order Index"},"chapter":{"$ref":"#/components/schemas/ChapterOut"}},"type":"object","required":["id","chapter_id","order_index","chapter"],"title":"ChapterGroupMemberOut"},"ChapterGroupMembersUpdateRequest":{"properties":{"chapter_ids":{"items":{"type":"integer"},"type":"array","title":"Chapter Ids","description":"Complete list of chapter IDs (order preserved)"}},"type":"object","required":["chapter_ids"],"title":"ChapterGroupMembersUpdateRequest"},"ChapterGroupOut":{"properties":{"id":{"type":"integer","title":"Id"},"work_id":{"type":"integer","title":"Work Id"},"name":{"type":"string","title":"Name"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"},"member_count":{"type":"integer","title":"Member Count","default":0},"min_sort_key":{"type":"number","title":"Min Sort Key"},"item_type":{"type":"string","title":"Item Type","default":"group"}},"type":"object","required":["id","work_id","name","created_at","updated_at","min_sort_key"],"title":"ChapterGroupOut"},"ChapterGroupUpdateRequest":{"properties":{"name":{"anyOf":[{"type":"string","maxLength":512,"minLength":1},{"type":"null"}],"title":"Name","description":"New group name"}},"type":"object","title":"ChapterGroupUpdateRequest"},"ChapterOrGroup":{"properties":{"item_type":{"type":"string","enum":["chapter","group"],"title":"Item Type"},"data":{"anyOf":[{"$ref":"#/components/schemas/ChapterOut"},{"$ref":"#/components/schemas/ChapterGroupOut"}],"title":"Data"}},"type":"object","required":["item_type","data"],"title":"ChapterOrGroup","description":"Union type for mixed chapter/group list"},"ChapterOut":{"properties":{"id":{"type":"integer","title":"Id"},"work_id":{"type":"integer","title":"Work Id"},"idx":{"type":"integer","title":"Idx"},"sort_key":{"type":"number","title":"Sort Key"},"title":{"type":"string","title":"Title"}},"type":"object","required":["id","work_id","idx","sort_key","title"],"title":"ChapterOut"},"ChapterPromptOverrideRequest":{"properties":{"model":{"type":"string","maxLength":128,"minLength":1,"title":"Model","description":"Model identifier"},"template":{"type":"string","minLength":1,"title":"Template","description":"Prompt template to use for this run"},"parameters":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Parameters","description":"Optional structured parameter overrides"}},"type":"object","required":["model","template"],"title":"ChapterPromptOverrideRequest"},"ChapterPromptOverrideResponse":{"properties":{"token":{"type":"string","title":"Token"},"expires_at":{"type":"string","format":"date-time","title":"Expires At"}},"type":"object","required":["token","expires_at"],"title":"ChapterPromptOverrideResponse"},"ChapterScrapeErrorItem":{"properties":{"chapter":{"type":"number","title":"Chapter"},"reason":{"type":"string","title":"Reason"}},"type":"object","required":["chapter","reason"],"title":"ChapterScrapeErrorItem"},"ChapterScrapeRequest":{"properties":{"start":{"type":"number","minimum":1.0,"title":"Start","description":"Starting chapter number (supports decimals)"},"end":{"type":"number","minimum":1.0,"title":"End","description":"Ending chapter number (supports decimals)"},"force":{"type":"boolean","title":"Force","description":"If true, rescrape existing chapters","default":false}},"type":"object","required":["start","end"],"title":"ChapterScrapeRequest"},"ChapterScrapeResponse":{"properties":{"work_id":{"type":"integer","title":"Work Id"},"start":{"type":"number","title":"Start"},"end":{"type":"number","title":"End"},"force":{"type":"boolean","title":"Force","default":false},"status":{"type":"string","title":"Status"},"job_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Job Id"},"requested":{"type":"integer","title":"Requested","default":0},"created":{"type":"integer","title":"Created","default":0},"updated":{"type":"integer","title":"Updated","default":0},"skipped":{"type":"integer","title":"Skipped","default":0},"errors":{"items":{"$ref":"#/components/schemas/ChapterScrapeErrorItem"},"type":"array","title":"Errors"}},"type":"object","required":["work_id","start","end","status"],"title":"ChapterScrapeResponse"},"ChapterTranslationCreate":{"properties":{"chapter_id":{"type":"integer","title":"Chapter Id"},"cache_policy":{"type":"string","title":"Cache Policy","default":"reuse"},"params":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Params"}},"type":"object","required":["chapter_id"],"title":"ChapterTranslationCreate"},"ChapterTranslationOut":{"properties":{"id":{"type":"integer","title":"Id"},"chapter_id":{"type":"integer","title":"Chapter Id"},"status":{"type":"string","title":"Status"}},"type":"object","required":["id","chapter_id","status"],"title":"ChapterTranslationOut"},"ChapterTranslationStateOut":{"properties":{"chapter_translation_id":{"type":"integer","title":"Chapter Translation Id"},"status":{"type":"string","title":"Status"},"segments":{"items":{"$ref":"#/components/schemas/TranslationSegmentOut"},"type":"array","title":"Segments"}},"type":"object","required":["chapter_translation_id","status","segments"],"title":"ChapterTranslationStateOut"},"ChaptersWithGroupsResponse":{"properties":{"items":{"items":{"$ref":"#/components/schemas/ChapterOrGroup"},"type":"array","title":"Items"},"total_chapters":{"type":"integer","title":"Total Chapters"},"total_groups":{"type":"integer","title":"Total Groups"},"total_items":{"type":"integer","title":"Total Items"},"offset":{"type":"integer","title":"Offset"},"limit":{"type":"integer","title":"Limit"}},"type":"object","required":["items","total_chapters","total_groups","total_items","offset","limit"],"title":"ChaptersWithGroupsResponse"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"IngestSyosetuRequest":{"properties":{"novel_id":{"type":"string","pattern":"^n[a-z0-9]+$","title":"Novel Id","description":"Syosetu novel identifier (e.g. n4811fg)"},"chapter":{"type":"integer","minimum":1.0,"title":"Chapter","description":"Chapter number (1-indexed) to fetch"}},"type":"object","required":["novel_id","chapter"],"title":"IngestSyosetuRequest"},"LabStreamRequest":{"properties":{"text":{"type":"string","minLength":1,"title":"Text","description":"Text to translate"},"model":{"type":"string","title":"Model","description":"Model identifier"},"template":{"type":"string","title":"Template","description":"Prompt template"},"params":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Params","description":"Optional parameters"}},"type":"object","required":["text","model","template"],"title":"LabStreamRequest"},"ModelInfoOut":{"properties":{"id":{"type":"string","title":"Id"},"name":{"type":"string","title":"Name"},"provider":{"type":"string","title":"Provider"},"max_tokens":{"type":"integer","title":"Max Tokens"},"supports_streaming":{"type":"boolean","title":"Supports Streaming","default":true},"cost_per_1m_input":{"type":"number","title":"Cost Per 1M Input","default":0.0},"cost_per_1m_output":{"type":"number","title":"Cost Per 1M Output","default":0.0}},"type":"object","required":["id","name","provider","max_tokens"],"title":"ModelInfoOut","description":"Information about a supported LLM model."},"ModelsListOut":{"properties":{"items":{"items":{"$ref":"#/components/schemas/ModelInfoOut"},"type":"array","title":"Items"},"total":{"type":"integer","title":"Total"}},"type":"object","required":["items","total"],"title":"ModelsListOut","description":"list of available models."},"PaginatedPromptVersionsOut":{"properties":{"items":{"items":{"$ref":"#/components/schemas/PromptVersionOut"},"type":"array","title":"Items"},"total":{"type":"integer","title":"Total"},"limit":{"type":"integer","title":"Limit"},"offset":{"type":"integer","title":"Offset"}},"type":"object","required":["items","total","limit","offset"],"title":"PaginatedPromptVersionsOut"},"PaginatedPromptsOut":{"properties":{"items":{"items":{"$ref":"#/components/schemas/PromptOut"},"type":"array","title":"Items"},"total":{"type":"integer","title":"Total"},"limit":{"type":"integer","title":"Limit"},"offset":{"type":"integer","title":"Offset"}},"type":"object","required":["items","total","limit","offset"],"title":"PaginatedPromptsOut"},"PaginatedWorksOut":{"properties":{"items":{"items":{"$ref":"#/components/schemas/WorkOut"},"type":"array","title":"Items"},"total":{"type":"integer","title":"Total"},"limit":{"type":"integer","title":"Limit"},"offset":{"type":"integer","title":"Offset"}},"type":"object","required":["items","total","limit","offset"],"title":"PaginatedWorksOut"},"PromptCreateRequest":{"properties":{"name":{"type":"string","maxLength":255,"minLength":1,"title":"Name","description":"Prompt name"},"description":{"anyOf":[{"type":"string","maxLength":2000},{"type":"null"}],"title":"Description","description":"Optional description"}},"type":"object","required":["name"],"title":"PromptCreateRequest"},"PromptDetailOut":{"properties":{"id":{"type":"integer","title":"Id"},"name":{"type":"string","title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"owner_work_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Owner Work Id"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"},"latest_version":{"anyOf":[{"$ref":"#/components/schemas/PromptVersionOut"},{"type":"null"}]}},"type":"object","required":["id","name","created_at","updated_at"],"title":"PromptDetailOut","description":"Prompt with latest version info included."},"PromptOut":{"properties":{"id":{"type":"integer","title":"Id"},"name":{"type":"string","title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"owner_work_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Owner Work Id"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"}},"type":"object","required":["id","name","created_at","updated_at"],"title":"PromptOut"},"PromptUpdateRequest":{"properties":{"name":{"anyOf":[{"type":"string","maxLength":255,"minLength":1},{"type":"null"}],"title":"Name","description":"New prompt name"},"description":{"anyOf":[{"type":"string","maxLength":2000},{"type":"null"}],"title":"Description","description":"New description"}},"type":"object","title":"PromptUpdateRequest"},"PromptVersionCreateRequest":{"properties":{"model":{"type":"string","maxLength":128,"minLength":1,"title":"Model","description":"Model name (e.g., gpt-4)"},"template":{"type":"string","maxLength":50000,"minLength":1,"title":"Template","description":"F-string template for the prompt"},"parameters":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Parameters","description":"Optional metadata parameters"},"created_by":{"anyOf":[{"type":"string","maxLength":255},{"type":"null"}],"title":"Created By","description":"Optional creator identifier"}},"type":"object","required":["model","template"],"title":"PromptVersionCreateRequest"},"PromptVersionOut":{"properties":{"id":{"type":"integer","title":"Id"},"prompt_id":{"type":"integer","title":"Prompt Id"},"version_number":{"type":"integer","title":"Version Number"},"model":{"type":"string","title":"Model"},"template":{"type":"string","title":"Template"},"parameters":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Parameters"},"created_by":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Created By"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["id","prompt_id","version_number","model","template","created_at"],"title":"PromptVersionOut"},"TranslationSegmentOut":{"properties":{"id":{"type":"integer","title":"Id"},"start":{"type":"integer","title":"Start"},"end":{"type":"integer","title":"End"},"order_index":{"type":"integer","title":"Order Index"},"src":{"type":"string","title":"Src"},"tgt":{"type":"string","title":"Tgt"},"flags":{"items":{"type":"string"},"type":"array","title":"Flags"}},"type":"object","required":["id","start","end","order_index","src","tgt"],"title":"TranslationSegmentOut"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"WorkImportRequest":{"properties":{"url":{"type":"string","minLength":1,"format":"uri","title":"Url","description":"URL to the work homepage or chapter"},"force":{"type":"boolean","title":"Force","description":"Force re-sync even if the work exists","default":false}},"type":"object","required":["url"],"title":"WorkImportRequest"},"WorkOut":{"properties":{"id":{"type":"integer","title":"Id"},"title":{"type":"string","title":"Title"},"source":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Source"},"source_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Source Id"},"source_meta":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Source Meta"}},"type":"object","required":["id","title"],"title":"WorkOut"},"WorkPromptUpdateRequest":{"properties":{"prompt_id":{"type":"integer","title":"Prompt Id","description":"The prompt ID to set as default for the work"}},"type":"object","required":["prompt_id"],"title":"WorkPromptUpdateRequest"}}}}